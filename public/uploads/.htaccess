# Sécurisation du dossier uploads
# Empêcher l'exécution de scripts

# Désactiver l'exécution de scripts
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Autoriser seulement les fichiers d'images et vidéos
<FilesMatch "\.(jpg|jpeg|png|gif|webp|mp4|webm|avi|mov|wmv|flv)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Empêcher l'accès aux fichiers cachés
<FilesMatch "^\.">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Empêcher l'accès aux fichiers de sauvegarde
<FilesMatch "\.(bak|backup|old|tmp|temp)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Désactiver l'affichage du contenu des dossiers
Options -Indexes

# Empêcher l'accès aux fichiers .htaccess
<Files ".htaccess">
    Order Deny,Allow
    Deny from all
</Files>

# Headers de sécurité
<IfModule mod_headers.c>
    # Empêcher le hotlinking
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    
    # Cache pour les images
    <FilesMatch "\.(jpg|jpeg|png|gif|webp)$">
        Header set Cache-Control "public, max-age=31536000"
    </FilesMatch>
    
    # Cache pour les vidéos
    <FilesMatch "\.(mp4|webm|avi|mov|wmv|flv)$">
        Header set Cache-Control "public, max-age=31536000"
    </FilesMatch>
</IfModule>
